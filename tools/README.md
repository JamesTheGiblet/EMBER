# EMBER Experimentation Tools

This directory contains a suite of Python scripts designed to monitor, control, and analyze EMBER evolution experiments. These tools leverage the bots' JSON APIs to provide everything from real-time monitoring to fully automated, multi-generation evolutionary runs.

---

## Prerequisites

Before using these tools, you need to install the required Python libraries.

```bash
# Install all required libraries with one command
pip install requests pyserial pandas matplotlib seaborn
```

- **`requests`**: For communicating with the bots' web APIs.
- **`pyserial`**: For logging data from a bot connected via USB.

---

## The Tools

### 1. `swarm_monitor.py`

**Purpose:** A real-time, terminal-based dashboard for monitoring the status of all EMBER bots on the network.

**Usage:**

```bash
# Monitor the default 9 bots (ember-bot-0 to ember-bot-8)
python swarm_monitor.py

# Monitor a different number of bots (e.g., 3)
python swarm_monitor.py --count 3

# Change the refresh rate to every 5 seconds
python swarm_monitor.py --refresh 5
```

**What it shows:**

- **Status:** `ALIVE`, `DEAD`, or `OFFLINE`.
- **Energy:** A color-coded bar graph of each bot's energy level.
- **Fitness:** The current survival time (`alive_time`).
- **Genome:** The bot's current `light_threshold` and `efficiency`.
- **Network:** The IP address of each bot.

**Best for:** Getting a quick, at-a-glance overview of your entire population's health and status before and during an experiment.

---

### 2. `evolution_experiment.py`

**Purpose:** The primary script for automating a complete, multi-generation evolution experiment from start to finish.

**Usage:**

```bash
# Run a default experiment (10 generations, 30 mins each, 9 bots)
python evolution_experiment.py

# Run a shorter test experiment
python evolution_experiment.py --generations 3 --time 300 --count 4
```

**What it does:**

1. **Initializes** the population with random genomes (for Generation 0).
2. **Runs** each generation for a specified duration.
3. **Logs** the fitness and genome data for every bot to a CSV file.
4. **Selects** the top-performing bots ("winners").
5. **Breeds** the next generation using a crossover of winner genomes.
6. **Mutates** the new population to introduce variation.
7. **Repeats** the cycle automatically.

**Output:** A comprehensive CSV log file (e.g., `evolution_log_20251128_231045.csv`) containing all the data from the experiment, ready for analysis.

---

### 3. `genome_analyzer.py`

**Purpose:** To analyze the CSV log files generated by `evolution_experiment.py` or `serial_logger.py` and provide statistical and visual insights into the evolutionary process.

**Usage:**

```bash
# Analyze the log file from an automated experiment
python genome_analyzer.py evolution_log_20251128_231045.csv
```

**What it does:**

1. Reads the CSV data.
2. Calculates and prints a statistical summary, comparing the genomes of "winners" vs. "losers".
3. Generates and displays a multi-panel plot showing:
    - The **Fitness Landscape** (which genomes survived longest).
    - The **Evolution of Population** over generations.
    - The **Distribution** of winning vs. losing genes.

**Output:** A detailed summary in the console and a PNG image file (e.g., `evolution_log_..._analysis.png`) with the analysis plots.

---

### 4. `serial_logger.py`

**Purpose:** To log fitness data from a single bot connected directly to your computer via a USB serial port.

**Usage:**

```bash
# On Windows
python serial_logger.py COM3

# On macOS / Linux
python serial_logger.py /dev/tty.usbserial-XXXX
```

**What it does:**

- Listens to the specified serial port for the bot's status updates.
- Parses the data and saves it to a timestamped CSV file.

**Best for:**

- Debugging a single bot.
- Collecting data when WiFi is unavailable.
- Simple, single-organism survival tests.

---

## Recommended Workflow

These tools are designed to work together to create a seamless experimental process.

### Fully Automated Experiment (95% of use cases)

1. **Check Swarm Status:**
    - Run `python swarm_monitor.py` to ensure all your bots are online and responding.

2. **Run the Experiment:**
    - Execute `python evolution_experiment.py` with your desired parameters (generation count, time, etc.).
    - Let the script run to completion. This can take several hours or days.

3. **Analyze the Results:**
    - Once the experiment is finished, run `python genome_analyzer.py your_log_file.csv`.
    - Review the console output and the generated PNG plot to understand how your population adapted.

### Manual or Single-Bot Testing

1. **Collect Data:**
    - Connect a single bot via USB and run `python serial_logger.py <PORT_NAME>` to collect data over a period.

2. **Analyze Data:**
    - Run `python genome_analyzer.py the_serial_log_file.csv` to see a basic correlation between that bot's genome and its performance over time.
